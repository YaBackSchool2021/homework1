# Фича - рейтинг пассажира
- Описание
Создание в приложении для водителей Yandex Pro возможность оценки пассажира(0-5) после поездки, а также просмотр оценки пассажира после подтверждения поездки. В приложении Yandex Go для пассажира добавить возможность просматривать свой рейтинг, высчитываемый по формуле, меньше учитывающей оценки водителей с низкими баллами и меньше учитывающей более старые оценки.
- Гипотезы
  - Данный функционал позволит защитить водителей от плохих пассажиров, ведь можно будет отказаться от поездки если рейтинг очень плохой(или возможно не принимать её вовсе).
  - Для пассажиров появляется мотивация вести себя более аккуратно и вежливо в такси.


- Архитектура
При окончании поездки записываем очередную оценку пользователя в БД вместе с оценкой водителя и timastamp. При запросе подсчитываем оценку по выбранной формуле и отдаём клиентской стороне. Также возможно в будущем можно будет добавить в БД элемент позваляющий не хранить все оценки, а подсчитывать их итеративно, храня последюю общую оценку, при добавлении новой пересчитывать на лету и текущую оценку.
![](http://www.plantuml.com/plantuml/png/LP71IiD048Rl-nJp016BnnoaXDmyj10ldcIRNMHHqx2xBLNneA0NXHwz-WX1B0HBwolClf5JcBWiX2Gp_Fc-oUpOUMdzulP6jFGqjMbbu-52DaglfdOk_j_Ww1HcihxMZO8SffFg78wbKbKzjneUb3LBRI-Doc6LGIkTqyqLD-uoS8TK3lSPS90R_b78sfkbz7g09tEKXU0swQaYCtvWXx_OXwVm3hWFhxZ17VvW3tIbzHVkyPkIpzJQXdLKbKLYgHQpid2YB4Z2nK7qYHiIRR4dMaVSFgo1U1tXT-4jl4GU0_ZJOTAJqGWcPqBfD3U8uZ8v6FyqxZ-bf8iQquqExWy0)
![](http://www.plantuml.com/plantuml/png/SoWkIImgAStDuIe0qfd9cGM9UIKAaObvAQaLxlvSC8Q2hfr2Kc9oTcfUYeALWhjhY89-SN9-KQfzPefj1LTYSabcMM99Aam9YbakJbnGOQ0XG1vG_uNv5_PTs7sn-MBxXQqNzbxOSM6hmeLz5zj07A34BhXv8BqkJgXsWwtbIac5gK4r7-voAmKZ0mC5Vs-4IeJh7804qCS0)
- MVP
  - В качетсве MVP можно вместо какой-либо формулы подсчёта рейтинга брать обычное среднее, это избавит нас от запроса на оценку самого водителя. 
- API можно посмотреть по [ссылке](https://app.swaggerhub.com/apis/Test85483/rating_service/1.0.0) или в файле
- Тестирование
При написании кода покрыть юнит-тестами. Стоит проверить граничные случаи, когда это первая поездка с оценкой. Также следует провести нагрузочное тестирование для получения информации о необходимых мощностях для стабильной работы фичи.
- Раскатка фичи
Перед раскаткой фичи на всю аудиторию следует подключить её сотрудникам Яндекса. После этого провести АБ тесты для подтверждения метрик, которые нас интересуют. Следует обратить внимание на: количество отмен заказов водителями, рост оценки на промежутке времени(работает ли стимул к аккуратному поведению для пассажиров), изменение количества заказов у людей с оценками на краях интервала(0-0.5 и 4.5 - 5). После этого имеет смысл включить фичу для самых активных пассажиров(к примеру от 25 заказов такси в месяц). После этого постепенно включать фичу по классам такси. Сначала премиальному сегменту, а в конце эконом классу. Таким образом возможно удастся избежать очень быстрого роста нагрузки. В процессе мониторить нагрузку на все сегменты, обеспечивающие работоспособность, и надеяться что ничего не повалится. 